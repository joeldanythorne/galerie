<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Ketarot</title>
  <link rel="stylesheet" href="./style.css">
</head>

<body>
<main id=app>

<h1 id="titre"></h1>
<div id="galerie-wrapper"></div>
<script>

const queryString = window.location.search;
console.log(queryString);

const urlParams = new URLSearchParams(queryString);


states_dictionary2={ 
  '01': "vitrai-uvh",
  '02': "bleuet",
  '03': "bottine",
  '04': "clown",
  '05': "conspipuppet",
  '06': "crimesoda",
  '07': "ensemble",
  '08': "evildead",
  '09': "file-indienne",
  '10': "friday13",
  '11': "gaudet",
  '12': "godzilla",
  '13': "groundhog",
  '14': "guenilles",
  '15': "hugo",
  '16': "karltremblay",
  '17': "karma",
  '18': "lego",
  '19': "lotr",
  '20': "louiseville2024",
  '21': "lynda",
  '22': "mado",
  '23': "maillet",
  '24': "matrix",
  '25': "orgonite01",
  '26': "orgonite3",
  '27': "orgonite-de-nowel",
  '28': "peter",
  '29': "probtechniques",
  '30': "pti-joel",
  '31': "mitevh",
  '32': "napu",
  '33': "singerome",
  '34': "starwars",
  '35': "steve",
  '36': "taser",
  '37': "theremin",
  '38': "trump",
  '39': "trump2",
  '40': "une-fois-au-chalet",
  '41': "uvh",
  '42': "stucco",
  '43': "nightmare"
}

var viewer = urlParams.get('viewer').toLowerCase()

//let text = "<h1>Collection de " + viewer + "</h1>";
document.getElementById("titre").innerHTML = "<h1>Collection de " + viewer + "</h1>";
let text =  '<section class="galerie">';

console.log("File:: ./collectioninfo/"+ viewer +".json")


async function Fetching() {
  let text = '<section class="galerie">';

  try {
    const response = await fetch('./collectioninfo/' + viewer + '.json');

    if (!response.ok) {
      console.error('Erreur de chargement du JSON pour', viewer, response.status);
      text += '<p class="error">Impossible de charger la collection.</p>';
    } else {
      const jsonData = await response.json();

      console.log('Collection chargée pour :', viewer);

      const totalCards = Object.keys(states_dictionary2).length;

      for (let i = 1; i <= totalCards; i++) {
        // 01, 02, 03, ..., 43
        const znumber = (i < 10) ? '0' + i : i.toString();

        // Nom clé dans le JSON, ex: "vitrai-uvh"
        const cardKey = states_dictionary2[znumber];

        // Par défaut → sans-cadre
        let classe = 'sans-cadre';

        // On regarde si cette clé existe dans le JSON
        const entry = jsonData[cardKey];

        if (Array.isArray(entry) && entry.length >= 3) {
          const cadre  = entry[0] === 1; // [0] → cadre
          const sketch = entry[1] === 1; // [1] → sketch
          const oeuvre = entry[2] === 1; // [2] → oeuvre

          // Priorité : oeuvre > sketch > cadre
          if (oeuvre) {
            classe = 'tableau oeuvre';
          } else if (sketch) {
            classe = 'tableau sketch';
          } else if (cadre) {
            classe = 'tableau cadre';
          } else {
            classe = 'sans-cadre';
          }
        }

        console.log(`Affichage : ${classe} → ${cardKey} (c${znumber})`);

        text += `
          <div class="three-d-wrapper">
            <div class="${classe} c${znumber} animated"></div>
          </div>
        `;
      }
    }
  } catch (err) {
    console.error('Erreur dans Fetching() :', err);
    text += '<p class="error">Erreur interne lors du chargement des cartes.</p>';
  }

  text += '</section>';

  // Injection dans le container (ID)
  const wrapper = document.getElementById('galerie-wrapper');
  if (wrapper) {
    wrapper.innerHTML = text;
  } else {
    console.error('⚠️ Élément #galerie-wrapper introuvable dans le DOM.');
  }
}

// Lancer au chargement
Fetching();




</script>

<!-- <style class="hover"></style> -->


</main>

</body>
</html>
